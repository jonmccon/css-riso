<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Seeded Ink Print Typography</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />

<style>
  /* ============================
     Demo page styling
  ============================ */
  body {
    margin: 0;
    padding: 4rem 2rem;
    background: #f7f5f1;
    font-family: Georgia, "Times New Roman", serif;
    color: #111;
  }

  section {
    max-width: 900px;
    margin: 0 auto 4rem;
  }

  h2 {
    font-size: 0.85rem;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    opacity: 0.6;
    margin-bottom: 1rem;
  }

  .demo-text {
    font-size: clamp(1.2rem, 3vw, 2.3rem);
    line-height: 1.45;
    margin: 0;
  }

  /* ============================
     Ink print utilities
  ============================ */

  .ink-print {
    position: relative;
  }

  /* Optional: micro jitter */
  .ink-print--jitter {
    display: inline-block;
  }

  .ink-print--jitter > span {
    display: inline-block;
  }

  .ink-print--jitter > span:nth-child(odd) {
    transform: translate(-0.4px, 0.5px);
  }

  .ink-print--jitter > span:nth-child(even) {
    transform: translate(0.5px, -0.3px);
  }

  /* Optional: paper grain overlay */
  .ink-print--paper::after {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    background-image:
      repeating-linear-gradient(
        0deg,
        rgba(0,0,0,0.025),
        rgba(0,0,0,0.025) 1px,
        transparent 1px,
        transparent 2px
      );
    mix-blend-mode: multiply;
    opacity: 0.15;
  }
</style>
</head>

<body>

<!-- ============================
     SVG FILTER TEMPLATES
     (never mutated)
============================ -->
<svg width="0" height="0" aria-hidden="true" focusable="false">
  <defs>

    <!-- ========= RGB TEMPLATE ========= -->
    <filter id="ink-template-rgb"
      x="-20%" y="-20%" width="140%" height="140%"
      color-interpolation-filters="sRGB">

      <feColorMatrix in="SourceGraphic"
        values="1 0 0 0 0   0 0 0 0 0   0 0 0 0 0   0 0 0 1 0"
        result="r"/>
      <feColorMatrix in="SourceGraphic"
        values="0 0 0 0 0   0 1 0 0 0   0 0 0 0 0   0 0 0 1 0"
        result="g"/>
      <feColorMatrix in="SourceGraphic"
        values="0 0 0 0 0   0 0 0 0 0   0 0 1 0 0   0 0 0 1 0"
        result="b"/>

      <feOffset in="r" result="rOff"/>
      <feOffset in="g" result="gOff"/>
      <feOffset in="b" result="bOff"/>

      <feTurbulence type="fractalNoise" result="noise"/>

      <feDisplacementMap in="rOff" in2="noise" result="rDisp"/>
      <feDisplacementMap in="gOff" in2="noise" result="gDisp"/>
      <feDisplacementMap in="bOff" in2="noise" result="bDisp"/>

      <feBlend in="rDisp" in2="gDisp" mode="screen" result="rg"/>
      <feBlend in="rg" in2="bDisp" mode="screen"/>
    </filter>

    <!-- ========= CMY TEMPLATE ========= -->
    <filter id="ink-template-cmy"
      x="-20%" y="-20%" width="140%" height="140%"
      color-interpolation-filters="sRGB">

      <feColorMatrix in="SourceGraphic"
        values="0 0 0 0 0   1 0 0 0 0   1 0 0 0 0   0 0 0 1 0"
        result="c"/>
      <feColorMatrix in="SourceGraphic"
        values="1 0 0 0 0   0 0 0 0 0   1 0 0 0 0   0 0 0 1 0"
        result="m"/>
      <feColorMatrix in="SourceGraphic"
        values="1 0 0 0 0   1 0 0 0 0   0 0 0 0 0   0 0 0 1 0"
        result="y"/>

      <feOffset in="c" result="cOff"/>
      <feOffset in="m" result="mOff"/>
      <feOffset in="y" result="yOff"/>

      <feTurbulence type="fractalNoise" result="noise"/>

      <feDisplacementMap in="cOff" in2="noise" result="cDisp"/>
      <feDisplacementMap in="mOff" in2="noise" result="mDisp"/>
      <feDisplacementMap in="yOff" in2="noise" result="yDisp"/>

      <feBlend in="cDisp" in2="mDisp" mode="multiply" result="cm"/>
      <feBlend in="cm" in2="yDisp" mode="multiply"/>
    </filter>

  </defs>
</svg>

<!-- ============================
     DEMOS
============================ -->

<section>
  <h2>RGB — seeded</h2>
  <p class="demo-text ink-print" data-seed="12">
    RGB misregistration feels digital and chromatic.
  </p>
</section>

<section>
  <h2>CMY — seeded</h2>
  <p class="demo-text ink-print ink-print--paper" data-seed="12">
    CMY overlap feels softer, inkier, and physical.
  </p>
</section>

<section>
  <h2>CMY + jitter + paper</h2>
  <p class="demo-text ink-print ink-print--jitter ink-print--paper" data-seed="42">
    <span>Une presse fatiguée,</span><br>
    <span>mais encore lisible.</span>
  </p>
</section>

<!-- ============================
     SEEDED FILTER GENERATOR
============================ -->
<script>
  // Deterministic RNG
  function mulberry32(seed) {
    return function () {
      let t = seed += 0x6D2B79F5;
      t = Math.imul(t ^ t >>> 15, t | 1);
      t ^= t + Math.imul(t ^ t >>> 7, t | 61);
      return ((t ^ t >>> 14) >>> 0) / 4294967296;
    };
  }

  const defs = document.querySelector('svg defs');

  document.querySelectorAll('.ink-print').forEach((el, index) => {
    const seed = Number(el.dataset.seed ?? index + 1);
    const rand = mulberry32(seed);

    const mode = el.classList.contains('ink-print--cmy') ? 'cmy' : 'rgb';
    const template = document.getElementById(`ink-template-${mode}`);
    if (!template) return;

    const filter = template.cloneNode(true);
    const filterId = `ink-${mode}-${seed}-${index}`;
    filter.id = filterId;

    const dx = (rand() - 0.5) * 2;
    const dy = (rand() - 0.5) * 2;
    const freq = 0.6 + rand() * 0.4;

    filter.querySelectorAll('feOffset').forEach(o => {
      o.setAttribute('dx', dx.toFixed(2));
      o.setAttribute('dy', dy.toFixed(2));
    });

    const turb = filter.querySelector('feTurbulence');
    turb.setAttribute('seed', Math.floor(rand() * 1000));
    turb.setAttribute('baseFrequency', freq.toFixed(2));

    filter.querySelectorAll('feDisplacementMap').forEach(d => {
      d.setAttribute('scale', (1 + rand()).toFixed(2));
    });

    defs.appendChild(filter);
    el.style.filter = `url(#${filterId})`;
  });
</script>

</body>
</html>
